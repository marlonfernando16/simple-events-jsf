<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:i="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:c="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
	<meta name="viewport"
		content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<meta http-equiv="x-ua-compatible" content="ie=edge" />
	<title>Dashboard</title>
	<!-- Font Awesome -->
	<link rel="stylesheet"
		href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" />
	<!-- Bootstrap core CSS -->
	<!-- Bootstrap core CSS -->
	<h:outputStylesheet name="dashboard/css/bootstrap.min.css" />
	<!-- Material Design Bootstrap -->
	<h:outputStylesheet name="dashboard/css/mdb.min.css" />
	<!-- Your custom styles (optional) -->
	<h:outputStylesheet name="dashboard/css/style.min.css" />
	<style>
.map-container {
	overflow: hidden;
	padding-bottom: 56.25%;
	position: relative;
	height: 0;
}

.map-container iframe {
	left: 0;
	top: 0;
	height: 100%;
	width: 100%;
	position: absolute;
}

.modal-backdrop {
	z-index: -1;
}

.navbar {
	z-index: -2;
}

footer.page-footer .footer-copyright {
	z-index: -2 !important;
}
</style>
</h:head>

<h:body class="grey lighten-3">

	<head>
<!--Main Navigation-->
<!-- Sidebar -->
<div class="sidebar-fixed position-fixed">
	<h:form>
		<div class="list-group list-group-flush">
			<a class="logo-wrapper waves-effect"> <img src=""
				class="img-fluid" alt="Coloque a logo aqui" />
			</a>
			<!-- Listar todos os eventos -->
			<h:commandLink styleClass="list-group-item active waves-effect"
				action="/dashboard/eventos?faces-redirect=true">
				<i class="fas fa-calendar mr-3"></i>Eventos
          </h:commandLink>
			<i:if test="#{loginBean.admin || loginBean.empresa}">
				<!-- Listar todas as especialidades -->
				<h:commandLink
					styleClass="list-group-item list-group-item-action waves-effect"
					action="/dashboard/especialidades?faces-redirect=true">
					<i class="fas fa-calendar mr-3"></i>Especialidades
            </h:commandLink>
			</i:if>
			<!-- Listar apenas os eventos submetidos -->
			<h:commandLink
				styleClass="list-group-item list-group-item-action waves-effect"
				action="/dashboard/submissoes?faces-redirect=true">
				<i class="fas fa-check-square mr-3"></i>Submissões
          </h:commandLink>
			<!-- Criar um evento -->
			<h:commandLink
				styleClass="list-group-item list-group-item-action waves-effect"
				action="/dashboard/evento?faces-redirect=true">
				<i class="fas fa-calendar-plus mr-3"></i>Criar Evento
          </h:commandLink>
			<i:if test="#{loginBean.admin || loginBean.empresa}">
				<!-- Criar especialidade -->
				<h:commandLink
					styleClass="list-group-item list-group-item-action waves-effect"
					action="/dashboard/especialidade?faces-redirect=true">
					<i class="fas fa-calendar-plus mr-3"></i>Criar Especialidade
            </h:commandLink>
			</i:if>
			<!-- Ver perfil do usuário -->
			<h:commandLink
				styleClass="list-group-item list-group-item-action waves-effect"
				action="/dashboard/perfil?faces-redirect=true">
				<i class="fas fa-user mr-3"></i>Perfil
          </h:commandLink>
		</div>
	</h:form>
</div>
<!-- Sidebar -->

<!-- Navbar -->
<nav
	class="navbar fixed-top navbar-expand-lg navbar-light white scrolling-navbar">
<div class="container-fluid">

	<!-- Collapse -->
	<button class="navbar-toggler" type="button" data-toggle="collapse"
		data-target="#navbarSupportedContent"
		aria-controls="navbarSupportedContent" aria-expanded="false"
		aria-label="Toggle navigation">
		<span class="navbar-toggler-icon"></span>
	</button>

	<!-- Links -->
	<div class="collapse navbar-collapse" id="navbarSupportedContent">

		<!-- Left -->
		<ul class="navbar-nav mr-auto">
		</ul>

		<!-- Right -->
		<ul class="navbar-nav nav-flex-icons">
			<li class="nav-item dropdown"><a
				class="nav-link dropdown-toggle" id="navbarDropdownMenuLink"
				data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					<i class="fas fa-bell"></i>
			</a>
				<div class="dropdown-menu dropdown-primary"
					aria-labelledby="navbarDropdownMenuLink">
					<a class="dropdown-item" href="#">Menssagem</a>
				</div></li>
			<li class="nav-item"><a href=""
				class="nav-link border border-light rounded"> <i
					class="fas fa-user-circle mr-2"></i>#{sessionScope.loginUser}
			</a></li>
		</ul>

	</div>

</div>
</nav>
<!-- Navbar -->
<!--Main Navigation-->
	</head>


	<!--Main layout-->
	<main class="pt-5 mx-lg-5">
	<div class="container-fluid mt-5">
		<!-- Heading -->
		<div class="card mb-4 wow fadeIn">

			<!--Card content-->
			<div class="card-body d-sm-flex justify-content-between">

				<h4 class="mb-2 mb-sm-0 pt-1">
					<!-- <a href="" target="_blank">Home</a>
              <span>/</span> -->
					<span>Eventos</span>
				</h4>

				<form class="d-flex justify-content-center">
					<!-- Default input -->
					<input type="search" placeholder="Type your query"
						aria-label="Search" class="form-control" />
					<button class="btn btn-primary btn-sm my-0 p" type="submit">
						<i class="fas fa-search"></i>
					</button>

				</form>

			</div>

		</div>
		<!-- Heading -->

		<!--Grid row-->
		<div class="row wow fadeIn">

			<i:forEach items="#{eventoBean.findAllEventos()}" var="evento">

				<!--Grid column-->
				<div class="col-md-3 mb-2">

					<!--Card-->
					<div class="card">

						<!--Card image-->
						<div class="view overlay">
							<img
								src="https://mdbootstrap.com/wp-content/uploads/2017/11/brandflow-tutorial-fb.jpg"
								class="card-img-top" alt="" /> <a data-toggle="modal"
								data-target="#modal_description_event#{evento.id}">
								<div class="mask rgba-white-slight"></div>
							</a>
						</div>

						<!--Card content-->
						<div class="card-body">
							<!--Title-->
							<h4 class="card-title">#{evento.nome}</h4>
							<!--Text-->
							<p class="card-text">Descricao: #{evento.descricao}</p>
							<p class="card-text">Local: #{evento.local}</p>
							<p class="card-text">Data: #{evento.data}</p>
						</div>

						<!-- Card footer Data de publicaÃ§Ã£o-->
						<div class="card-footer text-muted text-center mt-4">2 days
							ago</div>

					</div>
					<!--/.Card-->
				</div>

				<!--Grid row-->
				<!-- Modal de submissão -->
				<div class="modal fade" id="modal_description_event#{evento.id}"
					tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
					aria-hidden="true">
					<div class="modal-dialog modal-notify modal-info" role="document">

						<h:form id="modal_description_event#{evento.id}" tabindex="-1">
							<!--Content-->
							<div class="modal-content">
								<!--Header-->
								<div class="modal-header">
									<p class="heading lead">#{evento.nome}</p>

									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true" class="white-text">&times;</span>
									</button>
								</div>

								<!--Body-->
								<div class="modal-body">
									<div>
										<h3>Descrição</h3>
										<br />
										<p>#{evento.descricao}</p>
										<h3>Data</h3>
										<br />
										<p>#{evento.data}</p>
										<h3>Local</h3>
										<br />
										<p>#{evento.local}</p>
										<h3>Criado por:</h3>
										<br />
										<p>#{evento.owner.nome}</p>
									</div>
									<h:panelGroup
										rendered="#{sessionScope.user.email ne evento.owner.email}">
										<hr />
										<h3>Vagas</h3>
										<br />
										<p:selectManyCheckbox id="checkboxTest"
											value="#{candidatoVagaBean.vagas}">
											<f:selectItems value="#{evento.vagas}" var="vaga"
												itemLabel="#{vaga.especialidade.nome}"
												itemValue="#{vaga.id}" />
										</p:selectManyCheckbox>
									</h:panelGroup>
									<i:if test="#{sessionScope.user.email eq evento.owner.email}">
										<div class="container-fluid mt-5">
											<!--Grid row-->
											<div class="row wow fadeIn">

												<!--Grid column-->
												<div class="col-md-12 mb-2">

													<!--Card-->
													<div class="card">
														<!--Card content-->
														<div class="card-body">
															<!-- Form -->
															<h:form id="login-form">
																<!-- Heading -->
																<h3 class="card-title">
																	<strong>Vagas</strong>
																</h3>
																<hr />
																
																
																<h:selectManyCheckbox value="#{candidatoVagaBean.candidatos}" >
																	<i:forEach var="vaga" items="#{evento.vagas}">
																		<h5>#{vaga.especialidade.nome}</h5>
																		
																		<i:forEach var="candidatovaga" items="${vaga.candidatovaga}" varStatus="loop">
																			
																			 <f:selectItem class="custom-control custom-checkbox"  itemValue="#{candidatovaga.id}" itemLabel="#{candidatovaga.candidato.email}"/>
																			 <br/>
																		</i:forEach>
																	</i:forEach>
																</h:selectManyCheckbox>
															</h:form>
															<!-- Form -->
														</div>
													</div>
													<!--/.Card-->

												</div>
												<!--Grid column-->
											</div>
											<!--Grid row-->

										</div>
									</i:if>
								</div>

								<!--Footer-->
								<div class="modal-footer justify-content-center">
									<h:panelGroup rendered="#{sessionScope.user.email ne evento.owner.email}">
										<hr />
										<h:commandButton value="Inscrever" class="btn btn-info"
										action="#{candidatoVagaBean.candidatar}" />
									</h:panelGroup>
									<h:panelGroup rendered="#{sessionScope.user.email eq evento.owner.email}">
											<hr />
										<h:commandButton value="Finalizar" class="btn btn-info"
										action="#{candidatoVagaBean.finalizar}" />
									</h:panelGroup>
									<a type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</a>
								</div>
							</div>
							<!--/.Content-->
						</h:form>
					</div>
				</div>

			</i:forEach>

			<!--Grid column-->
		</div>

	</div>
	</main>
	<!--Main layout-->

	<!--Footer-->
	<footer
		class="page-footer fixed-bottom text-center font-small primary-color-dark darken-2 mt-4 wow fadeIn"
		style="z-index: -2;"> <!--Copyright-->
	<div class="footer-copyright py-3">
		© 2019 Copyright: <a href=""> EquipeTOP.com </a>
	</div>
	<!--/.Copyright--> </footer>
	<!--/.Footer-->

	<!-- SCRIPTS -->
	<!-- JQuery -->
	<h:outputScript library="javax.faces" name="jsf.js" target="head" />
	<h:outputScript name="dashboard/js/jquery-3.4.0.min.js" />
	<!-- Bootstrap tooltips -->
	<h:outputScript name="dashboard/js/popper.min.js" />
	<!-- Bootstrap core JavaScript -->
	<h:outputScript name="dashboard/js/bootstrap.min.js" />
	<!-- MDB core JavaScript -->
	<h:outputScript name="dashboard/js/mdb.min.js" />
	<!-- Initializations -->
	<script type="text/javascript">
		// Animations initialization
		new WOW().init();
	</script>
</h:body>

</html>